<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>비동기 통신(vanillar JS를 이용한 비동기 통신 예제)</title>
    <script>
      //로딩 버튼을 누르면 서버에 있는 hello.txt파일을 비동기 통신방식으로 얻어와 div영역에 그 내용을 출력하자.
      function txtLoad() {
        let xhttp = new XMLHttpRequest(); //XMLHttpRequest  객체(ajax객체) 생성//xml파일 달라고 하는 구문
        if (xhttp != null) {
          // ajax가 지원 된다면...
          xhttp.onreadystatechange = function () {
            //onreadystatechange: 이벤트 , 값이 변할 때 뒤에 오는 콜백 함수 실행
            //onreadystatechange: XMLHttpRequest의 속성이며, 클라이언트의 현재 상태 반환 해줌
            if (this.readyState == 4 && this.status == 200) {
              //여기서 this는 xhttp이다. //this.readyState == 4: 통신이 끝났고, this.status ==200 : 통신이 성공되었다면
              document.getElementById("output").innerHTML = this.responseText;
              //this.responseText:
              // xhttp.open()가 보내주고 onreadystatechange = function () 함수가 받아온 값이 this이고, 요청했던 데이터에서 받은 텍스트를 output이라는 아이디를 가진곳에 innerHTML에 넣어줌.
            }
          };
        } else {
          alert("웹 브라우저가 비동기 통신 방식을 지원하지 않습니다.!");
        }
        xhttp.open("get", "http://gottclass6.cafe24.com/lke/hello.txt"); //요청
        xhttp.send(); //통신시작
      }
    </script>
  </head>
  <body>
    <input type="button" value="로딩" onclick="txtLoad();" />
    <div id="output"></div>
  </body>
</html>
